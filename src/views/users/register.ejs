<%- include('../layout/header.ejs') %>
<div class="container">
    <section class="vh-100" style="background-color: #eee">
        <div class="container h-100">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-lg-12 col-xl-11">
                    <div class="card text-black" style="border-radius: 25px">
                        <div class="card-body p-md-5">
                            <div class="row justify-content-center">
                                <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                                    <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Sign up</p>
                                    <form action="/register" method="post" class="mx-1 mx-md-4 was-validated">                        
                                        <div class="d-flex flex-row align-items-center mb-4">
                                            <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                                            <div data-mdb-input-init class="form-outline flex-fill mb-0">
                                                <input name="fullname" type="text" id="form3Example1c" class="form-control" placeholder="Your Name" />
                                                <div class="invalid-feedback">
                                                    Vui lòng nhập tên của bạn.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-row align-items-center mb-4">
                                            <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                                            <div data-mdb-input-init class="form-outline flex-fill mb-0">
                                                <input name="email" type="email" id="form3Example3c" class="form-control" placeholder="Your Email" />
                                                <div class="invalid-feedback">
                                                    Vui lòng nhập địa chỉ email hợp lệ.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-row align-items-center mb-4">
                                            <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                                            <div data-mdb-input-init class="form-outline flex-fill mb-0">
                                                <input name="password" type="password" id="password" class="form-control" placeholder="Password" />
                                                <div class="invalid-feedback" id="password-length-message">
                                                    Mật khẩu không được dưới 6 kí tự.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-row align-items-center mb-4">
                                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                                            <div data-mdb-input-init class="form-outline flex-fill mb-0">
                                                <input type="password" id="confirm-password" class="form-control" placeholder="Repeat your password" />
                                                <div class="invalid-feedback" id="password-match-message">
                                                    Mật khẩu không khớp.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                                            <button name="submit" type="submit" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary btn-lg">Register</button>
                                        </div>
                                    </form>                                   
                                </div>
                                <div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">
                                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/draw1.webp" class="img-fluid" alt="Sample image">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var fullnameInput = document.getElementById('form3Example1c');
            var emailInput = document.getElementById('form3Example3c');
        
            fullnameInput.addEventListener('blur', function() {
                validateName(fullnameInput);
            });
        
            emailInput.addEventListener('blur', function() {
                validateEmail(emailInput);
            });
        
            fullnameInput.addEventListener('input', function() {
                validateName(fullnameInput);
            });
        
            emailInput.addEventListener('input', function() {
                validateEmail(emailInput);
            });
        
            function validateName(inputElement) {
                var invalidFeedback = inputElement.nextElementSibling;
                var regex = /^[a-zA-ZÀ-ỹ\s]+$/;
                if (!regex.test(inputElement.value.trim())) {
                    inputElement.style.borderColor = 'red';
                    invalidFeedback.textContent = 'Tên không được chứa số hoặc ký tự đặc biệt.';
                    invalidFeedback.style.color = 'red';
                    invalidFeedback.style.display = 'block';
                } else {
                    inputElement.style.borderColor = '';
                    invalidFeedback.style.display = 'none';
                }
            }
        
            function validateEmail(inputElement) {
                var invalidFeedback = inputElement.nextElementSibling;
                var regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
                if (inputElement.value.trim() === '') {
                    inputElement.style.borderColor = ''; // Reset border color if empty
                    invalidFeedback.style.display = 'none'; // Hide feedback if empty
                } else if (!regex.test(inputElement.value.trim())) {
                    inputElement.style.borderColor = 'red';
                    invalidFeedback.textContent = 'Vui lòng nhập địa chỉ email hợp lệ.';
                    invalidFeedback.style.color = 'red';
                    invalidFeedback.style.display = 'block';
                } else {
                    inputElement.style.borderColor = '';
                    invalidFeedback.style.display = 'none';
                }
            }
        });
        
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirm-password');
        const lengthMessageDiv = document.getElementById('password-length-message');
        const matchMessageDiv = document.getElementById('password-match-message');
    
        function validatePasswordLength() {
            if (passwordInput.value.length < 6) {
                passwordInput.classList.add('is-invalid');
                passwordInput.setCustomValidity('Mật khẩu không được dưới 6 kí tự');
                lengthMessageDiv.textContent = 'Mật khẩu không được dưới 6 kí tự';
                lengthMessageDiv.style.display = 'block';
            } else {
                passwordInput.classList.remove('is-invalid');
                passwordInput.setCustomValidity('');
                lengthMessageDiv.style.display = 'none';
            }
        }
    
        function validatePasswordMatch() {
            if (passwordInput.value !== confirmPasswordInput.value) {
                confirmPasswordInput.classList.add('is-invalid');
                confirmPasswordInput.setCustomValidity('Mật khẩu không khớp');
                matchMessageDiv.textContent = 'Mật khẩu không khớp';
                matchMessageDiv.style.display = 'block';
            } else {
                confirmPasswordInput.classList.remove('is-invalid');
                confirmPasswordInput.setCustomValidity('');
                matchMessageDiv.style.display = 'none';
            }
        }
    
        passwordInput.addEventListener('input', validatePasswordLength);
        confirmPasswordInput.addEventListener('input', validatePasswordMatch);
    </script>
    <%- include('../layout/footer.ejs') %>
